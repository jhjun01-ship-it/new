<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cafe24 PRO VOC 대시보드</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8fafb;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #5a6c7d 0%, #6c7b7f 100%);
            color: white;
            padding: 30px 0;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .kpi-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }

        .kpi-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #5a6c7d;
            margin-bottom: 5px;
        }

        .kpi-label {
            font-size: 1rem;
            color: #666;
            font-weight: 500;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .chart-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 3px solid #5a6c7d;
            padding-bottom: 10px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background-color: #f8f9fc;
            font-weight: 600;
            color: #333;
        }

        .data-table tr:hover {
            background-color: #f8f9fc;
        }

        .filter-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-section select,
        .filter-section input {
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            min-width: 150px;
        }

        .filter-section select:focus,
        .filter-section input:focus {
            outline: none;
            border-color: #5a6c7d;
        }

        .export-btn {
            background: linear-gradient(135deg, #5a6c7d 0%, #6c7b7f 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
        }

        .insight-card {
            background: linear-gradient(135deg, #6c7b7f 0%, #8b9dc3 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 10px 0;
        }

        .insight-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .keyword-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .keyword {
            background: rgba(90, 108, 125, 0.15);
            color: #34495e;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            border: 1px solid rgba(90, 108, 125, 0.2);
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }

            .header h1 {
                font-size: 2rem;
            }
        }

        .alert-card {
            background: linear-gradient(135deg, #d4a574 0%, #c08552 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .category-detail {
            display: none;
            background: #f8f9fc;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .category-item {
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .category-item:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Cafe24 PRO VOC 대시보드</h1>
            <p>2025.08.26 기준 (총 300건 분석)</p>
        </div>

        <!-- 상단 KPI -->
        <div class="kpi-section">
            <div class="kpi-card">
                <div class="kpi-value">300</div>
                <div class="kpi-label">총 VOC 건수</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">57</div>
                <div class="kpi-label">통화 실패/불가</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">70</div>
                <div class="kpi-label">신청/절차 미완료</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">36</div>
                <div class="kpi-label">관심/긍정 반응</div>
            </div>
        </div>

        <!-- 주의 알림 -->
        <div class="alert-card">
            🚨 주요 이슈: 통화 실패율 19.0%, 신청 미완료 23.3% - 즉시 개선 필요
        </div>

        <!-- 프로젝트 인사이트 -->
        <div class="chart-container full-width">
            <div class="chart-title">🎯 프로젝트 관리 인사이트</div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="insight-card" style="background: linear-gradient(135deg, #7ba05b 0%, #8fb069 100%);">
                    <div class="insight-title">✅ 잘하고 있는 점</div>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>핵심 가치 전달</strong>: "운영 인력 부족" 해결이 가장 강력한 니즈</li>
                        <li><strong>기술 차별화</strong>: SEO 최적화, 마켓 연동 기능 어필 효과적</li>
                        <li><strong>생태계 효과</strong>: 기존 카페24 고객 추천을 통한 신뢰 구축</li>
                        <li><strong>성공 사례</strong>: jhbandf(9건) → 카톡연결 완료</li>
                    </ul>
                </div>

                <div class="insight-card" style="background: linear-gradient(135deg, #b8860b 0%, #daa520 100%);">
                    <div class="insight-title">🔧 개선 필요 영역</div>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>연락처 품질</strong>: 19% 통화 실패 → 리드 수집 프로세스 개선</li>
                        <li><strong>온보딩 UX</strong>: 23% 신청 미완료 → 신청서 간소화</li>
                        <li><strong>패션 정책</strong>: 카테고리 제외로 인한 이탈 발생</li>
                        <li><strong>PG 허들</strong>: 결제 시스템 변경 요구사항</li>
                    </ul>
                </div>
            </div>

            <div style="margin-top: 20px; padding: 15px; background: #f8f9fc; border-radius: 8px;">
                <h4 style="margin-bottom: 10px;">🎯 우선순위 액션 아이템</h4>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div style="background: #c08552; color: white; padding: 10px; border-radius: 5px; text-align: center;">
                        <strong>HIGH</strong><br>
                        긍정 반응 36건<br>→ 신청 완료 집중
                    </div>
                    <div style="background: #daa520; color: white; padding: 10px; border-radius: 5px; text-align: center;">
                        <strong>MEDIUM</strong><br>
                        신청서 프로세스<br>간소화
                    </div>
                    <div style="background: #7ba05b; color: white; padding: 10px; border-radius: 5px; text-align: center;">
                        <strong>LOW</strong><br>
                        하이서울쇼룸<br>ROI 측정
                    </div>
                </div>
            </div>
        </div>

        <!-- 필터 섹션 -->
        <div class="filter-section">
            <label>카테고리 필터:</label>
            <select id="categoryFilter">
                <option value="all">전체</option>
                <option value="신청/절차 미완료">신청/절차 미완료</option>
                <option value="통화 실패/불가">통화 실패/불가</option>
                <option value="관심/긍정 반응">관심/긍정 반응</option>
                <option value="행사/홍보 관련">행사/홍보 관련</option>
                <option value="무응답/연락 보류">무응답/연락 보류</option>
                <option value="취소/거절">취소/거절</option>
                <option value="대상아님">대상아님</option>
                <option value="검토 중">검토 중</option>
                <option value="시기 보류">시기 보류</option>
            </select>

            <input type="text" id="searchInput" placeholder="mall_id 또는 키워드 검색">

            <button class="export-btn" onclick="exportToCSV()">CSV 내보내기</button>
        </div>

        <!-- 차트 섹션 -->
        <div class="dashboard-grid">
            <div class="chart-container">
                <div class="chart-title">VOC 카테고리별 분포</div>
                <canvas id="categoryChart"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">통화 실패 세부 사유</div>
                <canvas id="callFailChart"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">신청 미완료 세부 사유</div>
                <canvas id="incompleteChart"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">취소/거절 세부 사유</div>
                <canvas id="rejectionChart"></canvas>
            </div>
        </div>

        <!-- 텍스트 인사이트 -->
        <div class="chart-container full-width">
            <div class="chart-title">텍스트 인사이트</div>

            <div class="insight-card">
                <div class="insight-title">🔍 카페24 PRO 서비스 긍정 키워드</div>
                <div class="keyword-cloud">
                    <span class="keyword">효율적인 상품 진열</span>
                    <span class="keyword">부족한 일손을 대신</span>
                    <span class="keyword">리소스 절감</span>
                    <span class="keyword">SEO 최적화</span>
                    <span class="keyword">마켓 연동가능</span>
                    <span class="keyword">운영대행</span>
                    <span class="keyword">많은 도움</span>
                    <span class="keyword">시간,비용 절약</span>
                </div>
            </div>

            <div class="insight-card">
                <div class="insight-title">⚠️ 주요 부정/장애 키워드</div>
                <div class="keyword-cloud">
                    <span class="keyword">통화 안됨</span>
                    <span class="keyword">전원 꺼짐</span>
                    <span class="keyword">필요없음</span>
                    <span class="keyword">취소</span>
                    <span class="keyword">거절</span>
                    <span class="keyword">패션 제외</span>
                    <span class="keyword">PG 변경</span>
                </div>
            </div>
        </div>

        <!-- 비즈니스 인사이트 분석 -->
        <div class="chart-container full-width">
            <div class="chart-title">🔍 비즈니스 인사이트 & 패턴 분석</div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <!-- 고객 여정 분석 -->
                <div style="background: #f8f9fc; padding: 20px; border-radius: 8px;">
                    <h4 style="color: #5a6c7d; margin-bottom: 15px;">📈 고객 여정 단계별 분석</h4>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #7ba05b;">
                            <strong>앱 설치 단계:</strong> 85건 (28.3%)<br>
                            <span style="font-size: 12px; color: #666;">설치만 하고 신청서 미작성</span>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #daa520;">
                            <strong>서비스 안내 단계:</strong> 45건 (15.0%)<br>
                            <span style="font-size: 12px; color: #666;">설명 후 검토 중</span>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #5a6c7d;">
                            <strong>신청서 작성 단계:</strong> 32건 (10.7%)<br>
                            <span style="font-size: 12px; color: #666;">접수 완료 또는 작성 중</span>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #8b9dc3;">
                            <strong>서비스 진행:</strong> 18건 (6.0%)<br>
                            <span style="font-size: 12px; color: #666;">카톡 연결 및 운영 시작</span>
                        </div>
                    </div>
                </div>

                <!-- 업종별 반응 분석 -->
                <div style="background: #f8f9fc; padding: 20px; border-radius: 8px;">
                    <h4 style="color: #5a6c7d; margin-bottom: 15px;">🏪 업종별 반응 패턴</h4>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong>의류/패션:</strong> 높은 관심도 ❌ 서비스 제외<br>
                            <span style="font-size: 12px; color: #666;">패션 카테고리 후순위 → 이탈 주요 원인</span>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong>액세서리/소품:</strong> 높은 성공률 ✅<br>
                            <span style="font-size: 12px; color: #666;">핸드폰케이스, 주얼리 등 적극적 반응</span>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong>식품/건강:</strong> 중간 관심도 ⚖️<br>
                            <span style="font-size: 12px; color: #666;">제조업체 vs 유통업체 구분 필요</span>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong>B2B/렌탈:</strong> 낮은 적합도 ❌<br>
                            <span style="font-size: 12px; color: #666;">서비스 대상 외 → 초기 필터링 필요</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 시간대별 패턴 -->
            <div style="background: #f8f9fc; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h4 style="color: #5a6c7d; margin-bottom: 15px;">⏰ 커뮤니케이션 패턴 분석</h4>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                        <div style="font-size: 24px; color: #c08552; font-weight: bold;">19%</div>
                        <div style="font-size: 14px; color: #666;">통화 실패율</div>
                        <div style="font-size: 12px; color: #999;">전화 안받음이 61% 차지</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                        <div style="font-size: 24px; color: #7ba05b; font-weight: bold;">23%</div>
                        <div style="font-size: 14px; color: #666;">신청 미완료율</div>
                        <div style="font-size: 12px; color: #999;">앱설치만 34% 차지</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                        <div style="font-size: 24px; color: #5a6c7d; font-weight: bold;">12%</div>
                        <div style="font-size: 14px; color: #666;">긍정 반응률</div>
                        <div style="font-size: 12px; color: #999;">실제 진행 가능성 높음</div>
                    </div>
                </div>
            </div>

            <!-- 핵심 장애 요인 -->
            <div style="background: linear-gradient(135deg, #5a6c7d 0%, #6c7b7f 100%); color: white; padding: 20px; border-radius: 8px;">
                <h4 style="margin-bottom: 15px;">🚧 핵심 장애 요인 & 해결 방안</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h5 style="margin-bottom: 10px; color: #f0f0f0;">📞 연락 장애</h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 14px; line-height: 1.6;">
                            <li>전화 안받음 (35건) - SMS/이메일 병행 필요</li>
                            <li>전원 꺼짐 (12건) - 다시간대 재시도</li>
                            <li>수신거부 (6건) - 초기 스크리닝 강화</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="margin-bottom: 10px; color: #f0f0f0;">🔧 시스템 장애</h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 14px; line-height: 1.6;">
                            <li>PG사 변경 부담 (8건) - 변경 지원 서비스</li>
                            <li>신청서 복잡도 (24건) - UI/UX 간소화</li>
                            <li>패션 카테고리 제외 (12건) - 로드맵 제시</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- 지역별 & 특수 프로그램 분석 -->
        <div class="chart-container full-width">
            <div class="chart-title">🌍 지역별 분포 & 특수 프로그램 현황</div>

            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
                <!-- 하이서울쇼룸 분석 -->
                <div style="background: #f8f9fc; padding: 20px; border-radius: 8px;">
                    <h4 style="color: #5a6c7d; margin-bottom: 15px;">🏢 하이서울쇼룸 프로그램 (26건)</h4>
                    <div style="background: white; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                        <p style="margin: 0; color: #333; line-height: 1.6;">
                            <strong>특징:</strong> 서울시 지원 프로그램으로 패션/의류 브랜드 중심<br>
                            <strong>상태:</strong> 별도 관리 체계로 운영 중<br>
                            <strong>ROI:</strong> 일반 영업 대비 전환율 측정 필요
                        </p>
                    </div>

                    <h5 style="color: #5a6c7d; margin: 15px 0 10px;">📊 주요 패턴</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #7ba05b;">
                            <strong>지역 집중도:</strong><br>
                            서울/경기 집중 (80%)
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #daa520;">
                            <strong>업종 특화:</strong><br>
                            패션/의류 전문
                        </div>
                    </div>
                </div>

                <!-- 성공 사례 -->
                <div style="background: linear-gradient(135deg, #7ba05b 0%, #8fb069 100%); color: white; padding: 20px; border-radius: 8px;">
                    <h4 style="margin-bottom: 15px;">🏆 성공 사례</h4>
                    <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 6px; margin-bottom: 10px;">
                        <strong>jhbandf</strong> (9건)<br>
                        <span style="font-size: 12px;">카톡 연결 완료 → 서비스 정착</span>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 6px; margin-bottom: 10px;">
                        <strong>maxn</strong> (2건)<br>
                        <span style="font-size: 12px;">긍정 반응 → 빠른 진행</span>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 6px;">
                        <strong>dynatoneshop</strong><br>
                        <span style="font-size: 12px;">아임웹 이전 → 만족도 높음</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 상세 VOC 리스트 -->
        <div class="chart-container full-width">
            <div class="chart-title">VOC 상세 리스트</div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>VOC No</th>
                        <th>Mall ID</th>
                        <th>카테고리</th>
                        <th>VOC 내용</th>
                        <th>등록일시</th>
                    </tr>
                </thead>
                <tbody id="vocTable">
                    <!-- 데이터가 JavaScript로 동적 생성됩니다 -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // VOC 데이터 (실제 CSV 데이터 기반)
        const vocData = [
            {
                voc_no: 24,
                mall_id: "k9638927",
                category: "관심/긍정 반응",
                subcategory: "긍정적 반응",
                content: "긍정 3.11통화 x /3.5일 통화x 패션쪽이라 후순위로 지연될수 있음을 안내하려 했음.",
                timestamp: "2025-08-26 12:32:27"
            },
            {
                voc_no: 25,
                mall_id: "wonvely73",
                category: "검토 중",
                subcategory: "내부 검토",
                content: "현재 서비스를 만져보고 있는 중, 제품이 나오지 않은 상태라 이후에 연락 주기로 함",
                timestamp: "2025-08-26 12:32:29"
            },
            {
                voc_no: 32,
                mall_id: "lotusplus",
                category: "통화 실패/불가",
                subcategory: "전화 안받음",
                content: "3.6일 전화통화 시도하였으나 안받으심.",
                timestamp: "2025-08-26 12:35:29"
            },
            {
                voc_no: 43,
                mall_id: "superyoni",
                category: "대상아님",
                subcategory: "업종 부적합",
                content: "공구 사이트인 것 같은데",
                timestamp: "2025-08-26 12:35:51"
            },
            {
                voc_no: 49,
                mall_id: "itemforyou",
                category: "대상아님",
                subcategory: "유통업체",
                content: "유통 / 제조사아님",
                timestamp: "2025-08-26 12:36:13"
            }
        ];

        // 카테고리별 데이터
        const categoryData = {
            "신청/절차 미완료": 70,
            "통화 실패/불가": 57,
            "관심/긍정 반응": 36,
            "행사/홍보 관련": 26,
            "무응답/연락 보류": 18,
            "취소/거절": 35,
            "대상아님": 28,
            "검토 중": 20,
            "시기 보류": 10
        };

        // 차트 생성
        function createCategoryChart() {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(categoryData),
                    datasets: [{
                        data: Object.values(categoryData),
                        backgroundColor: [
                            '#c08552', '#7ba05b', '#5a6c7d', '#8b9dc3',
                            '#daa520', '#b19cd9', '#87ceeb', '#d4a574', '#9db4ab'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.raw / total) * 100).toFixed(1);
                                    return `${context.label}: ${context.raw}건 (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createCallFailChart() {
            const ctx = document.getElementById('callFailChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['전화 안받음', '전원 꺼짐', '통화 후 끊음', '없는 번호'],
                    datasets: [{
                        label: '건수',
                        data: [35, 12, 6, 4],
                        backgroundColor: '#c08552',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#f0f0f0'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function createIncompleteChart() {
            const ctx = document.getElementById('incompleteChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['앱설치만', '신청서 안내', '서비스 안내', '접수 완료'],
                    datasets: [{
                        label: '건수',
                        data: [24, 22, 18, 6],
                        backgroundColor: '#7ba05b',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#f0f0f0'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function createRejectionChart() {
            const ctx = document.getElementById('rejectionChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['서비스 불필요', '패션 제외', '운영대행 거절', '기타'],
                    datasets: [{
                        label: '건수',
                        data: [18, 8, 6, 3],
                        backgroundColor: '#8b9dc3',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#f0f0f0'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // VOC 테이블 생성
        function createVOCTable() {
            const tbody = document.getElementById('vocTable');
            tbody.innerHTML = '';

            vocData.forEach(voc => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${voc.voc_no}</td>
                    <td>${voc.mall_id}</td>
                    <td><span class="keyword">${voc.category}</span></td>
                    <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis;">${voc.content}</td>
                    <td>${voc.timestamp}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // CSV 내보내기
        function exportToCSV() {
            let csvContent = "VOC No,Mall ID,카테고리,VOC 내용,등록일시\n";

            vocData.forEach(voc => {
                const row = [
                    voc.voc_no,
                    voc.mall_id,
                    voc.category,
                    `"${voc.content.replace(/"/g, '""')}"`,
                    voc.timestamp
                ].join(',');
                csvContent += row + "\n";
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'cafe24_voc_data.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // 필터 기능
        document.getElementById('categoryFilter').addEventListener('change', function() {
            // 실제 구현에서는 여기에 필터링 로직 추가
            console.log('Category filter changed:', this.value);
        });

        document.getElementById('searchInput').addEventListener('input', function() {
            // 실제 구현에서는 여기에 검색 로직 추가
            console.log('Search:', this.value);
        });

        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            createCategoryChart();
            createCallFailChart();
            createIncompleteChart();
            createRejectionChart();
            createVOCTable();
        });
    </script>
</body>
</html>
